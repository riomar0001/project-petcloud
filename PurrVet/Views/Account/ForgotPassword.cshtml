@{
    ViewBag.Title = "Forgot Password";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="hero-section d-flex flex-column justify-content-center">
    <div class="hero-wave"></div>

    <div class="container">
        <div class="row align-items-center justify-content-center text-center text-md-start">
            <div class="col-md-3 mb-4 mb-md-0 slogan-col">
                <h1 class="fw-bold forgot">
                    Healthy Pets,<br />Happy Homes.
                </h1>
            </div>

            <div class="col-md-2 mb-4 mb-md-0 paws-col d-flex justify-content-center">
                <img src="~/images/paws.png" alt="Paws" class="forgot-paws" />
            </div>

            <div class="col-md-5 d-flex justify-content-end">
                <div class="login-card shadow p-4 w-100" style="max-width: 400px; position: relative;">
                    <a href="/Account/Login" class="text-decoration-none d-flex align-items-center text-muted btn-back">
                        <i class="bi bi-arrow-left me-2"></i>
                    </a>

                    <h6 class="mb-3 text-center fw-bold">Reset your password.</h6>
                    <hr class="mb-4">

                    <form id="forgotPasswordForm">
                        <h6 class="fw-bold text-start mb-3">Forgot Password</h6>
                        <div class="mb-3">
                            <input type="email" id="email" name="email" class="form-control" placeholder="Enter your registered Email" required />
                        </div>

                        <div class="mb-3 text-muted small text-center">
                            Enter your email and we’ll send you a link to reset your password.
                        </div>

                        <div class="text-center my-1">
                            <img src="~/images/golden.png" alt="Golden Dog" class="dog-img" style="max-height:120px;" />
                        </div>

                        <button type="submit" class="btn-skyblue w-100">Send Reset Link</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="position-fixed top-0 end-0 p-3" style="z-index: 1050;">
    <div id="toastMessage" class="toast align-items-center text-white bg-success border-0" role="alert">
        <div class="d-flex">
            <div class="toast-body"></div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>

    $("#forgotPasswordForm").on("submit", function (e) {
        e.preventDefault();

        const email = $("#email").val();

        $.ajax({
            url: "/Account/ForgotPassword",
            type: "POST",
            data: { email: email },
            success: function (response) {
                let toast = new bootstrap.Toast($('#toastMessage'));
                const toastBody = $('#toastMessage .toast-body');

                if (response.success) {
                    $('#toastMessage').removeClass('bg-danger').addClass('bg-success');
                    toastBody.text(response.message);
                    $('#email').val('');
                } else {
                    $('#toastMessage').removeClass('bg-success').addClass('bg-danger');
                    toastBody.text(response.message);
                }

                toast.show();
            },
            error: function () {
                $('#toastMessage').removeClass('bg-success').addClass('bg-danger');
                $('#toastMessage .toast-body').text("Something went wrong. Please try again.");
                new bootstrap.Toast($('#toastMessage')).show();
            }
        });
    });
</script>
